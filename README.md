# CelestaPowerLog
1. Follow the [CELESTA and CELESTA quattro Light Engine® Instruction Manual](https://cms.lumencor.com/system/uploads/fae/file/asset/48/57-10015-F_Celesta_09092021.pdf) (3.3.3 Ethernet Connection and Control GUI) to set up LAN communication with the onboard computer of the Light Engine.
2. Run ``LogLaserPower.ps1`` on PowerShell (you might need to [change execution policies](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies) to run a script). It requires one parameter input to specify the laser line to be logged. For example, to log the fourth laser line (corresponding to the 546-nm line on a CELESTA Light Engine; note that the numbering starts from 0):
```
LogLaserPower.ps1 4
```
3. Keep the PowerShell session on for the entire logged session. The log will be on the current user's desktop. It is suggested to add the exposure time and the percentage intensity information (of the channel that used this laser line) manually to the filename of the log.
4. Each line in the log contains the following formatted information: **hour**(24-h clock)**:min:second**(1-ms accuracy)**,power**(in milliwatts). During most of the time, the laser will be off and the instantaneous power readout will simply be 0. Therefore, all 0's are ignored and not logged. The idle interval between consecutive inquiries is 12 ms (which does not include the latency due to communication and internal processing). To set it differently, change the value of ``$Interval`` in the code. The effective sampling frequency should follow the Nyquist–Shannon sampling theorem.
5. Run the MATLAB function ``reconstitutePulse`` using the log file to visually examine the inverse empirical cumulative distribution of instantaneous powers, assuming that all pulses from the session are equivalent. I am currently working on reconstructing the average pulse (which is inevitably smoothed because the readout of instantaneous powers can never actually be instantaneous).
